# Path to Oh My Zsh installation
export ZSH="$HOME/.oh-my-zsh"

# Theme
ZSH_THEME="crunch"

# fzf (must be set before oh-my-zsh loads)
export FZF_BASE=/usr/share/doc/fzf/examples

# Plugins
plugins=(git docker kubectl fzf zsh-autosuggestions zsh-syntax-highlighting)

source $ZSH/oh-my-zsh.sh

# Editor
export EDITOR='emacs'

# -----------------
# PATH additions
# -----------------
export PATH=$PATH:/usr/local/go/bin
export PATH="$HOME/go/bin:$PATH"
export PATH=$PATH:/usr/sbin
export PATH="$HOME/.config/emacs/bin:$PATH"

# bun
export BUN_INSTALL="$HOME/.bun"
export PATH="$BUN_INSTALL/bin:$PATH"

# depot_tools for Chromium development
export PATH="$HOME/depot_tools:$PATH"

# Local bin
export PATH="$HOME/.local/bin:$PATH"

# opencode
export PATH="$HOME/.opencode/bin:$PATH"

# pnpm
export PNPM_HOME="$HOME/.local/share/pnpm"
case ":$PATH:" in
  *":$PNPM_HOME:"*) ;;
  *) export PATH="$PNPM_HOME:$PATH" ;;
esac

# -----------------
# Sourced files
# -----------------
[ -f "$HOME/.local/bin/env" ] && . "$HOME/.local/bin/env"

# -----------------
# Custom tools
# -----------------
eval "$(try init ~/code/tries)"

# -----------------
# API Keys
# -----------------
export KERNEL_API_KEY={{ onepasswordRead "op://sa/dev/KERNEL_API_KEY" | quote }}
export OPENAI_API_KEY={{ onepasswordRead "op://sa/dev/OPENAI_API_KEY" | quote }}
export GOOGLE_API_KEY={{ onepasswordRead "op://sa/dev/GOOGLE_API_KEY" | quote }}
export OP_SERVICE_ACCOUNT_TOKEN={{ onepasswordRead "op://sa/dev/OP_SERVICE_ACCOUNT_TOKEN" | quote }}

# -----------------
# Aliases
# -----------------
alias ll='ls -l'
alias la='ls -A'
alias l='ls -CF'
alias ai='opencode run "generate a bash command for $*"'
alias claude='claude --dangerously-skip-permissions'
alias agent='agent --approve-mcps'

# -----------------
# cdc - quick cd to ~/code/kernel
# -----------------
cdc() {
    if [[ -z "$1" ]]; then
        cd ~/code/kernel
    else
        cd ~/code/kernel/"$1"
    fi
}

# Tab completion for cdc
_cdc() {
    local base_dir=~/code/kernel
    _path_files -W "$base_dir" -/
}
compdef _cdc cdc
